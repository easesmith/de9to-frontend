import{j as e,J as A,c as w,x as C,a9 as k,d as D,aa as _,r as R,ab as M,ac as S,ad as E,ae as V,af as z,e as L,f as p,g as j,h as N,i as b,l as g,V as P,B as y,_ as W}from"./index-C-yvlQ-I.js";import{_ as f}from"./react-stars-C-fjyYXQ.js";import{f as I}from"./format-CW0G_LzU.js";const m=({ratingValue:s,ratingStar:t,maxRating:l=500})=>{const a=Math.min(s/l*100,100);return e.jsxs("div",{className:"grid grid-cols-[6%_87%_6%] max-[900px]:grid-cols-[15%_70%_4%] items-center gap-3",children:[e.jsxs("p",{className:"font-inter text-xs font-medium",children:[t===1?`${t} star`:`${t} stars`," "]}),e.jsx("div",{className:"w-11/12 h-2 bg-[#d2d8df] rounded-3xl overflow-hidden",children:e.jsx("div",{className:"h-full rounded-3xl bg-[#95C22B]",style:{width:`${a}%`}})}),e.jsx("div",{className:"font-inter text-xs font-medium",children:s})]})},H=({allRating:s})=>{var c,d,r,n,x;const{reviewsByRating:t,averageRating:l}=s||{};let a=0;return t&&Object.keys(t).forEach(u=>{var h;a+=((h=t[u])==null?void 0:h.length)||0}),console.log("totalReviews",a),e.jsxs("div",{className:"border-2 border-[#95C22B] rounded-lg bg-[#95C22B1A] px-10 max-[500px]:px-4 py-6 w-full grid grid-cols-[24%_74%] max-[900px]:grid-cols-[30%_68%] max-[700px]:grid-cols-1 gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-inter font-medium text-[#0D0C22]",children:"Patient Reviews"}),e.jsx("h2",{className:"font-inter font-bold text-4xl mt-1",children:parseFloat(l==null?void 0:l.toFixed(1))}),e.jsx(f,{edit:!1,size:35,count:5,value:parseFloat(l==null?void 0:l.toFixed(1)),color2:"#FF8A00"}),e.jsxs("p",{className:"text-xs font-inter text-[#858585]",children:["(",a," Reviews)"]})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(m,{ratingStar:5,ratingValue:((c=t==null?void 0:t["5"])==null?void 0:c.length)||0,maxRating:a}),e.jsx(m,{ratingStar:4,ratingValue:((d=t==null?void 0:t["4"])==null?void 0:d.length)||0,maxRating:a}),e.jsx(m,{ratingStar:3,ratingValue:((r=t==null?void 0:t["3"])==null?void 0:r.length)||0,maxRating:a}),e.jsx(m,{ratingStar:2,ratingValue:((n=t==null?void 0:t["2"])==null?void 0:n.length)||0,maxRating:a}),e.jsx(m,{ratingStar:1,ratingValue:((x=t==null?void 0:t["1"])==null?void 0:x.length)||0,maxRating:a})]})]})},J=({rating:s})=>{var l,a,c,d,r;const t=((a=(l=s==null?void 0:s.patient)==null?void 0:l.name)==null?void 0:a.split(" "))||[];return e.jsx("div",{children:s&&e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-[8px_1fr] gap-3",children:[e.jsx("div",{className:"border-l-8 border-[#95C22B] h-full rounded-full w-2"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-inter text-xs text-[#858585]",children:(s==null?void 0:s.createdAt)&&I(new Date(s==null?void 0:s.createdAt),"MMM dd, yyy")}),e.jsx(f,{edit:!1,size:25,count:5,value:Number(s==null?void 0:s.patientRating),color2:"#FF8A00"}),e.jsxs("div",{className:"flex items-center gap-2 my-1",children:[e.jsxs("div",{className:"flex justify-center items-center w-[36px] h-[36px] rounded-full font-inter font-semibold text-sm text-[#95C22B] bg-[#eaf3d5]",children:[(c=t[0])==null?void 0:c.charAt(0),(d=t[1])==null?void 0:d.charAt(0)]}),e.jsx("p",{className:"font-inter font-semibold text-sm",children:(r=s==null?void 0:s.patient)==null?void 0:r.name})]}),e.jsx("p",{className:"font-inter font-normal text-sm mt-1 text-[#0D0C22]",children:s==null?void 0:s.patientRemarks})]})]}),e.jsx("div",{className:"h-[1px] w-[98%] ml-auto bg-[#8f8f8f] mt-8"})]})})};function O(s){return A({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1"},child:[]},{tag:"path",attr:{d:"M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z"},child:[]},{tag:"path",attr:{d:"M16 5l3 3"},child:[]}]})(s)}const Y=({isAddFeedbackModalOpen:s,setIsAddFeedbackModalOpen:t,dentistId:l,clinicId:a,reviewType:c,getData:d})=>{const r=w({resolver:C(k),defaultValues:{rating:0,desc:""}}),{res:n,fetchData:x,isLoading:u}=D(),{reset:h,handleSubmit:v,getValues:$,watch:T}=r,i=_("userInfo"),F=o=>{if(console.log("Data:",o),!i){W("Please Login to add review");return}c==="dentist"?x("/patient/add-dentist-rating",{patientRemarks:o.desc,patientRating:o.rating,patientId:i==null?void 0:i.userId,dentistId:l,reviewType:c}):x("/patient/post-review",{patientRemarks:o.desc,patientRating:o.rating,patientId:i==null?void 0:i.userId,clinicId:a,reviewType:c})};return R.useEffect(()=>{((n==null?void 0:n.status)===200||(n==null?void 0:n.status)===201)&&(console.log("add feedback res",n),d(),t(!1))},[n]),e.jsx(M,{open:s,onOpenChange:t,children:e.jsx(S,{className:"max-w-[450px] w-full",children:e.jsxs("div",{className:"max-h-[75vh] overflow-y-auto scrollBar",children:[e.jsxs(E,{className:"space-y-0",children:[e.jsx(V,{className:"font-inter font-bold text-[#0D0E0E] text-2xl pt-1 text-center",children:"Write Your feedback!"}),e.jsx(z,{className:"text-sm text-[#717171] font-inter text-center",children:"Please rate your experience below"})]}),e.jsx(L,{...r,children:e.jsxs("form",{onSubmit:v(F),className:"flex flex-col items-start gap-4 w-full",children:[e.jsxs("div",{className:"w-full flex flex-col gap-4 mt-4",children:[e.jsx(p,{control:r.control,name:"rating",render:({field:o})=>e.jsxs(j,{children:[e.jsx(N,{className:"font-inter text-sm text-[#1A1A1A] font-normal"}),e.jsx(b,{children:e.jsxs("div",{className:"flex w-[90%] sm:w-[80%] mx-auto justify-between items-center gap-3",children:[e.jsx(f,{onChange:o.onChange,size:35,count:5,value:o.value,color2:"#FF8A00"}),e.jsxs("p",{className:"text-[#717171] font-inter font-normal",children:[o.value,"/5 stars"]})]})}),e.jsx(g,{})]})}),e.jsx(p,{control:r.control,name:"desc",render:({field:o})=>e.jsxs(j,{children:[e.jsx(N,{className:"font-inter text-sm text-[#1A1A1A] font-normal",children:"Write something"}),e.jsx(b,{children:e.jsx(P,{placeholder:"Write here...",className:"placeholder:text-[#717171] min-h-[100px] resize-none",...o})}),e.jsx(g,{})]})})]}),e.jsx(y,{type:"submit",className:"bg-[#95C22B] mt-4 flex justify-center w-full h-12",children:"Submit feedback"})]})})]})})})};export{Y as A,H as R,O as T,J as a};
