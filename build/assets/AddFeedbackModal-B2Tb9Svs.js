import{j as e,G as A,l as w,r as C,D as k,m as D,n as _,o as R,p as M,B as S,_ as E}from"./index-DmouPCTn.js";import{_ as h}from"./react-stars-ChvkAcib.js";import{f as V}from"./format-CW0G_LzU.js";import{T as z}from"./textarea-CYvQgfBC.js";import{u as L,A as P,a as y,F as W,b as u,c as j,d as N,e as b,f as g}from"./usePostApiReq-Bc5-sulw.js";import{t as I}from"./zod-CUky7xw4.js";const m=({ratingValue:t,ratingStar:s,maxRating:l=500})=>{const a=Math.min(t/l*100,100);return e.jsxs("div",{className:"grid grid-cols-[6%_87%_6%] max-[900px]:grid-cols-[15%_70%_4%] items-center gap-3",children:[e.jsxs("p",{className:"font-inter text-xs font-medium",children:[s===1?`${s} star`:`${s} stars`," "]}),e.jsx("div",{className:"w-11/12 h-2 bg-[#d2d8df] rounded-3xl overflow-hidden",children:e.jsx("div",{className:"h-full rounded-3xl bg-[#95C22B]",style:{width:`${a}%`}})}),e.jsx("div",{className:"font-inter text-xs font-medium",children:t})]})},J=({allRating:t})=>{var c,d,r,o,x;const{reviewsByRating:s,averageRating:l}=t||{};let a=0;return s&&Object.keys(s).forEach(p=>{var f;a+=((f=s[p])==null?void 0:f.length)||0}),console.log("totalReviews",a),e.jsxs("div",{className:"border-2 border-[#95C22B] rounded-lg bg-[#95C22B1A] px-10 max-[500px]:px-4 py-6 w-full grid grid-cols-[24%_74%] max-[900px]:grid-cols-[30%_68%] max-[700px]:grid-cols-1 gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-inter font-medium text-[#0D0C22]",children:"Patient Reviews"}),e.jsx("h2",{className:"font-inter font-bold text-4xl mt-1",children:parseFloat(l==null?void 0:l.toFixed(1))}),e.jsx(h,{edit:!1,size:35,count:5,value:parseFloat(l==null?void 0:l.toFixed(1)),color2:"#FF8A00"}),e.jsxs("p",{className:"text-xs font-inter text-[#858585]",children:["(",a," Reviews)"]})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(m,{ratingStar:5,ratingValue:((c=s==null?void 0:s["5"])==null?void 0:c.length)||0,maxRating:a}),e.jsx(m,{ratingStar:4,ratingValue:((d=s==null?void 0:s["4"])==null?void 0:d.length)||0,maxRating:a}),e.jsx(m,{ratingStar:3,ratingValue:((r=s==null?void 0:s["3"])==null?void 0:r.length)||0,maxRating:a}),e.jsx(m,{ratingStar:2,ratingValue:((o=s==null?void 0:s["2"])==null?void 0:o.length)||0,maxRating:a}),e.jsx(m,{ratingStar:1,ratingValue:((x=s==null?void 0:s["1"])==null?void 0:x.length)||0,maxRating:a})]})]})},K=({rating:t})=>{var l,a,c,d,r;const s=((a=(l=t==null?void 0:t.patient)==null?void 0:l.name)==null?void 0:a.split(" "))||[];return e.jsx("div",{children:t&&e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-[8px_1fr] gap-3",children:[e.jsx("div",{className:"border-l-8 border-[#95C22B] h-full rounded-full w-2"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-inter text-xs text-[#858585]",children:(t==null?void 0:t.createdAt)&&V(new Date(t==null?void 0:t.createdAt),"MMM dd, yyy")}),e.jsx(h,{edit:!1,size:25,count:5,value:Number(t==null?void 0:t.patientRating),color2:"#FF8A00"}),e.jsxs("div",{className:"flex items-center gap-2 my-1",children:[e.jsxs("div",{className:"flex justify-center items-center w-[36px] h-[36px] rounded-full font-inter font-semibold text-sm text-[#95C22B] bg-[#eaf3d5]",children:[(c=s[0])==null?void 0:c.charAt(0),(d=s[1])==null?void 0:d.charAt(0)]}),e.jsx("p",{className:"font-inter font-semibold text-sm",children:(r=t==null?void 0:t.patient)==null?void 0:r.name})]}),e.jsx("p",{className:"font-inter font-normal text-sm mt-1 text-[#0D0C22]",children:t==null?void 0:t.patientRemarks})]})]}),e.jsx("div",{className:"h-[1px] w-[98%] ml-auto bg-[#8f8f8f] mt-8"})]})})};function Q(t){return A({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1"},child:[]},{tag:"path",attr:{d:"M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z"},child:[]},{tag:"path",attr:{d:"M16 5l3 3"},child:[]}]})(t)}const U=({isAddFeedbackModalOpen:t,setIsAddFeedbackModalOpen:s,dentistId:l,clinicId:a,reviewType:c,getData:d})=>{const r=L({resolver:I(P),defaultValues:{rating:0,desc:""}}),{res:o,fetchData:x,isLoading:p}=y(),{reset:f,handleSubmit:v,getValues:T,watch:$}=r,i=w("userInfo"),F=n=>{if(console.log("Data:",n),!i){E("Please Login to add review");return}c==="dentist"?x("/patient/add-dentist-rating",{patientRemarks:n.desc,patientRating:n.rating,patientId:i==null?void 0:i.userId,dentistId:l,reviewType:c}):x("/patient/post-review",{patientRemarks:n.desc,patientRating:n.rating,patientId:i==null?void 0:i.userId,clinicId:a,reviewType:c})};return C.useEffect(()=>{((o==null?void 0:o.status)===200||(o==null?void 0:o.status)===201)&&(console.log("add feedback res",o),d(),s(!1))},[o]),e.jsx(k,{open:t,onOpenChange:s,children:e.jsx(D,{className:"max-w-[450px] w-full",children:e.jsxs("div",{className:"max-h-[75vh] overflow-y-auto scrollBar",children:[e.jsxs(_,{className:"space-y-0",children:[e.jsx(R,{className:"font-inter font-bold text-[#0D0E0E] text-2xl pt-1 text-center",children:"Write Your feedback!"}),e.jsx(M,{className:"text-sm text-[#717171] font-inter text-center",children:"Please rate your experience below"})]}),e.jsx(W,{...r,children:e.jsxs("form",{onSubmit:v(F),className:"flex flex-col items-start gap-4 w-full",children:[e.jsxs("div",{className:"w-full flex flex-col gap-4 mt-4",children:[e.jsx(u,{control:r.control,name:"rating",render:({field:n})=>e.jsxs(j,{children:[e.jsx(N,{className:"font-inter text-sm text-[#1A1A1A] font-normal"}),e.jsx(b,{children:e.jsxs("div",{className:"flex w-[90%] sm:w-[80%] mx-auto justify-between items-center gap-3",children:[e.jsx(h,{onChange:n.onChange,size:35,count:5,value:n.value,color2:"#FF8A00"}),e.jsxs("p",{className:"text-[#717171] font-inter font-normal",children:[n.value,"/5 stars"]})]})}),e.jsx(g,{})]})}),e.jsx(u,{control:r.control,name:"desc",render:({field:n})=>e.jsxs(j,{children:[e.jsx(N,{className:"font-inter text-sm text-[#1A1A1A] font-normal",children:"Write something"}),e.jsx(b,{children:e.jsx(z,{placeholder:"Write here...",className:"placeholder:text-[#717171] min-h-[100px] resize-none",...n})}),e.jsx(g,{})]})})]}),e.jsx(S,{type:"submit",className:"bg-[#95C22B] mt-4 flex justify-center w-full h-12",children:"Submit feedback"})]})})]})})})};export{U as A,J as R,Q as T,K as a};
